let $form=$(".controller"),$p=$('input[type="number"]'),$inputImg=$(".input img"),inputImg=$inputImg,outputImg=$("canvas");function onClick(){outputImg.style.display="none";let t=$inputImg.getAttribute("src");console.log(t),t=t.replace(/\d/,(function(t){return(Number(t)+1)%3})),$inputImg.setAttribute("src",t)}function onTrans(t){t.preventDefault();let n=inputImg.width,e=inputImg.height;outputImg.width=n,outputImg.height=e;let o=Number($p.value),u=outputImg.getContext("2d");u.drawImage(inputImg,0,0,n,e);let i,r=u.getImageData(0,0,n,e),l=n*e;o>.5?(i=roundFractional(l*(1-o),0),convertImg(r)):i=roundFractional(l*o,0);let a={};for(let t=0;t<i;t++){let o=roundFractional(Math.random()*(n-1),0),u=roundFractional(Math.random()*(e-1),0),i=o+","+u;0===a[i]?--t:(a[i]=0,convertPixel(r,o,u))}u.putImageData(r,0,0),outputImg.style.display="block"}function convertImg(t){let n=t.width,e=t.height;for(let o=0;o<e;o++)for(let e=0;e<n;e++)convertPixel(t,e,o)}function convertPixel(t,n,e){let o=t.width,u=t.data,i=e*o*4+4*n;u[i+0]=255-u[i+0],u[i+1]=255-u[i+1],u[i+2]=255-u[i+2]}$form.onsubmit=onTrans,$inputImg.onclick=onClick;